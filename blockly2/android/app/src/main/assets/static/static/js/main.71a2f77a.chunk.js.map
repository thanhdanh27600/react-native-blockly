{"version":3,"sources":["useBlocklyWorkspace.js","debounce.jsx","BlocklyWorkspace.jsx","initContent/content.jsx","App.js","serviceWorker.js","index.js"],"names":["useBlocklyWorkspace","ref","initialXml","toolboxConfiguration","workspaceConfiguration","onWorkspaceChange","onImportXmlError","onInject","onDispose","React","useState","workspace","setWorkspace","xml","setXml","didInitialImport","setDidInitialImport","didHandleNewWorkspace","setDidHandleNewWorkspace","workspaceConfigurationRef","useRef","useEffect","current","toolboxConfigurationRef","updateToolbox","onInjectRef","onDisposeRef","handleWorkspaceChanged","useCallback","newWorkspace","Blockly","inject","toolbox","theme","Theme","Flyout","prototype","MARGIN","onDisposeFunction","dispose","listener","addChangeListener","removeChangeListener","func","wait","timeout","later","args","clearTimeout","setTimeout","debounce","newXml","Xml","domToText","workspaceToDom","callback","cancel","domToWorkspace","textToDom","e","importFromXml","BlocklyWorkspace","className","onXmlChange","editorDiv","onXmlChangeRef","defaultProps","ConfigFiles","INITIAL_XML","INITIAL_TOOLBOX_XML","INITIAL_TOOLBOX_JSON","kind","contents","name","colour","text","callbackKey","type","blockxml","custom","INITIAL_TOOLBOX_CATEGORIES","blocks","values","TIMES","shadow","fields","NUM","statements","DO","TEXT","App","btnRunRef","xmlInject","setXmlInject","run","setRun","setUartFeedback","initApi","interpreter","globalObject","JavaScript","addReservedWords","wrapper","alert","arguments","length","setProperty","createNativeFunction","console","log","prompt","id","highlightBlock","disabled","createAsyncFunction","timeInSeconds","num","window","ReactNativeWebView","postMessage","JSON","stringify","REQUEST","DATA","error","setLocale","Vi","STATEMENT_PREFIX","INFINITE_LOOP_TRAP","addEventListener","event","req","parse","data","thang","Blocks","init","this","jsonInit","block","getFieldValue","trai","phai","doi","min","max","value","Number","registerButtonCallback","workspaceToCode","Button","onClick","element","document","getElementsByClassName","style","opacity","display","dispatchEvent","Event","variant","code","myInterpreter","Interpreter","nextStep","step","zoom","controls","wheel","startScale","maxScale","minScale","scaleSpeed","pinch","horizontalLayout","toolboxPosition","modalRef","Spinner","animation","fontSize","Boolean","location","hostname","match","editor","createElement","ReactDOM","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"sQAkBA,IA0IeA,EA1Ia,SAAC,GAStB,IARLC,EAQI,EARJA,IACAC,EAOI,EAPJA,WACAC,EAMI,EANJA,qBACAC,EAKI,EALJA,uBACAC,EAII,EAJJA,kBACAC,EAGI,EAHJA,iBACAC,EAEI,EAFJA,SACAC,EACI,EADJA,UACI,EAC8BC,IAAMC,SAAS,MAD7C,mBACGC,EADH,KACcC,EADd,OAEkBH,IAAMC,SAASR,GAFjC,mBAEGW,EAFH,KAEQC,EAFR,OAG4CL,IAAMC,UAAS,GAH3D,mBAGGK,EAHH,KAGqBC,EAHrB,OAKFP,IAAMC,UAAS,GALb,mBAIGO,EAJH,KAI0BC,EAJ1B,KASEC,EAA4BV,IAAMW,OAAOhB,GAC/CK,IAAMY,WAAU,WACdF,EAA0BG,QAAUlB,IACnC,CAACA,IAEJ,IAAMmB,EAA0Bd,IAAMW,OAAOjB,GAC7CM,IAAMY,WAAU,WACdE,EAAwBD,QAAUnB,EAC9BA,GAAwBQ,GAC1BA,EAAUa,cAAcrB,KAEzB,CAACA,EAAsBQ,IAE1B,IAAMc,EAAchB,IAAMW,OAAOb,GAC3BmB,EAAejB,IAAMW,OAAOZ,GAClCC,IAAMY,WAAU,WACdI,EAAYH,QAAUf,IACrB,CAACA,IACJE,IAAMY,WAAU,WACdK,EAAaJ,QAAUd,IACtB,CAACA,IAEJ,IAAMmB,EAAyBlB,IAAMmB,aACnC,SAACC,GACKxB,GACFA,EAAkBwB,KAGtB,CAACxB,IAyFH,OArFAI,IAAMY,WAAU,WACd,IAAMQ,EAAeC,IAAQC,OAAO9B,EAAIqB,QAAnB,2BAChBH,EAA0BG,SADV,IAEnBU,QAAST,EAAwBD,QACjCW,MAAOC,OAETJ,IAAQK,OAAOC,UAAUC,OAAS,GAClCzB,EAAaiB,GACbb,GAAoB,GACpBE,GAAyB,GAErBO,EAAYH,SACdG,EAAYH,QAAQO,GAGtB,IAAMS,EAAoBZ,EAAaJ,QAGvC,OAAO,WACLO,EAAaU,UAETD,GACFA,EAAkBT,MAGrB,CAAC5B,IAGJQ,IAAMY,WAAU,WACVV,IAAcM,GAChBU,EAAuBhB,KAExB,CAACgB,EAAwBV,EAAuBN,IAGnDF,IAAMY,WAAU,WACd,GAAiB,MAAbV,EAAJ,CAIA,IAAM6B,EAAW,WACfb,EAAuBhB,IAGzB,OADAA,EAAU8B,kBAAkBD,GACrB,WACL7B,EAAU+B,qBAAqBF,OAEhC,CAAC7B,EAAWgB,IAGflB,IAAMY,WAAU,WACd,GAAiB,MAAbV,EAAJ,CADoB,MCtHT,SAAkBgC,EAAMC,GACrC,IAAIC,EAAU,KACVC,EAAQ,KAkBZ,MAAO,CAhBmB,WAAc,IAAD,uBAATC,EAAS,yBAATA,EAAS,gBACrCD,EAAQ,WACND,EAAU,KACVF,EAAI,WAAJ,EAAQI,IAEVC,aAAaH,GACbA,EAAUI,WAAWH,EAAOF,IAGf,WACG,OAAZC,IACFG,aAAaH,GACbC,OD2GyBI,EAAS,WAClC,IAAMC,EAASrB,IAAQsB,IAAIC,UACzBvB,IAAQsB,IAAIE,eAAe3C,IAEzBwC,IAAWtC,GAIfC,EAAOqC,KACN,KAdiB,mBAKbI,EALa,KAKHC,EALG,KAkBpB,OAFA7C,EAAU8B,kBAAkBc,GAErB,WACL5C,EAAU+B,qBAAqBa,GAC/BC,QAED,CAAC7C,EAAWE,IAGfJ,IAAMY,WAAU,WACVR,GAAOF,IAAcI,IA1I7B,SAAuBF,EAAKF,EAAWL,GACrC,IAEE,OADAwB,IAAQsB,IAAIK,eAAe3B,IAAQsB,IAAIM,UAAU7C,GAAMF,IAChD,EACP,MAAOgD,GAIP,OAHIrD,GACFA,EAAiBqD,IAEZ,GAmIWC,CAAc/C,EAAKF,EAAWL,IAE5CQ,EAAO,MAETE,GAAoB,MAErB,CAACH,EAAKF,EAAWI,EAAkBT,IAE/B,CAAEK,YAAWE,QE7HtB,SAASgD,EAAT,GAUI,IATF3D,EASC,EATDA,WACAC,EAQC,EARDA,qBACAC,EAOC,EAPDA,uBACA0D,EAMC,EANDA,UACAzD,EAKC,EALDA,kBACA0D,EAIC,EAJDA,YACAzD,EAGC,EAHDA,iBACAC,EAEC,EAFDA,SACAC,EACC,EADDA,UAEMwD,EAAYvD,IAAMW,OAAO,MACvBP,EAAQb,EAAoB,CAClCC,IAAK+D,EACL9D,aACAC,uBACAC,yBACAC,oBACAC,mBACAC,WACAC,cARMK,IAUFoD,EAAiBxD,IAAMW,OAAO2C,GAUpC,OATAtD,IAAMY,WAAU,WACd4C,EAAe3C,QAAUyC,IACxB,CAACA,IACJtD,IAAMY,WAAU,WACV4C,EAAe3C,SAAWT,GAC5BoD,EAAe3C,QAAQT,KAExB,CAACA,IAEG,qBAAKiD,UAAWA,EAAW7D,IAAK+D,IAIzCH,EAAiBK,aAhDI,CACnBhE,WAAY,KACZC,qBAAsB,KACtBC,uBAAwB,KACxB0D,UAAW,KACXzD,kBAAmB,KACnBC,iBAAkB,KAClByD,YAAa,KACbxD,SAAU,KACVC,UAAW,MAyCEqD,QCq+BAM,EAPK,CAClBC,YAhiCA,4PAiiCAC,oBAnaA,uzVAoaAC,qBAhiC2B,CAC3BC,KAAM,kBACNC,SAAU,CACR,CACED,KAAM,WACNE,KAAM,2BACNC,OAAQ,IACRF,SAAU,CACR,CACED,KAAM,SACNI,KAAM,qCACNC,YAAa,cAInB,CAAEL,KAAM,OACR,CACEA,KAAM,WACNE,KAAM,QACNC,OAAQ,IACRF,SAAU,CACR,CACED,KAAM,QACNM,KAAM,eAER,CACEN,KAAM,QACNO,SACE,mEAEJ,CACEP,KAAM,QACNO,SACE,sEAEJ,CACEP,KAAM,QACNM,KAAM,gBAER,CACEN,KAAM,QACNO,SACE,uEAEJ,CACEP,KAAM,QACNM,KAAM,cAER,CACEN,KAAM,QACNM,KAAM,mBAIZ,CACEN,KAAM,WACNE,KAAM,mBACNC,OAAQ,IACRF,SAAU,CACR,CACED,KAAM,QACNO,SACE,gMAQJ,CACEP,KAAM,QACNO,SACE,gGAIJ,CACEP,KAAM,QACNO,SACE,2hBAmBJ,CACEP,KAAM,QACNO,SACE,oIAIJ,CACEP,KAAM,QACNO,SACE,yGAMR,CACEP,KAAM,WACNE,KAAM,kBACNC,OAAQ,IACRF,SAAU,CACR,CACED,KAAM,QACNO,SACE,kOASJ,CACEP,KAAM,QACNO,SACE,qFAIJ,CACEP,KAAM,QACNO,SACE,gOASJ,CACEP,KAAM,QACNO,SACE,8NASJ,CACEP,KAAM,QACNO,SACE,6FAIJ,CACEP,KAAM,QACNO,SACE,8SAUJ,CACEP,KAAM,QACNO,SACE,wWAcJ,CACEP,KAAM,QACNO,SACE,6HAKJ,CACEP,KAAM,QACNO,SACE,+UAaJ,CACEP,KAAM,QACNO,SACE,sdAkBJ,CACEP,KAAM,QACNO,SACE,0UAaJ,CACEP,KAAM,QACNM,KAAM,uBAIZ,CACEN,KAAM,WACNE,KAAM,oBACNC,OAAQ,IACRF,SAAU,CACR,CACED,KAAM,QACNO,SACE,+TAUJ,CACEP,KAAM,QACNO,SACE,8EAIJ,CACEP,KAAM,QACNO,SACE,qQASJ,CACEP,KAAM,QACNO,SACE,yLAQJ,CACEP,KAAM,QACNO,SACE,uLAQJ,CACEP,KAAM,QACNO,SACE,wZAcJ,CACEP,KAAM,QACNO,SACE,uFAIJ,CACEP,KAAM,QACNO,SACE,kYAWJ,CACEP,KAAM,QACNO,SACE,wOASJ,CACEP,KAAM,QACNO,SACE,6NASJ,CACEP,KAAM,QACNO,SACE,uLAQJ,CACEP,KAAM,QACNO,SACE,8QAYR,CACEP,KAAM,WACNE,KAAM,eACNC,OAAQ,IACRF,SAAU,CACR,CACED,KAAM,QACNO,SACE,mRASJ,CACEP,KAAM,QACNO,SACE,+FAIJ,CACEP,KAAM,QACNO,SACE,4LAQJ,CACEP,KAAM,QACNM,KAAM,gBAER,CACEN,KAAM,QACNM,KAAM,iBAER,CACEN,KAAM,QACNO,SACE,+FAIJ,CACEP,KAAM,QACNO,SACE,0XAWJ,CACEP,KAAM,QACNO,SACE,uWAWJ,CACEP,KAAM,QACNO,SACE,+XAWJ,CACEP,KAAM,QACNO,SACE,yQAUJ,CACEP,KAAM,QACNO,SACE,sIAqER,CAAEP,KAAM,OACR,CACEA,KAAM,WACNE,KAAM,YACNM,OAAQ,WACRL,OAAQ,KAEV,CACEH,KAAM,WACNE,KAAM,SACNM,OAAQ,YACRL,OAAQ,KAEV,CAAEH,KAAM,OACR,CACEA,KAAM,WACNE,KAAM,oCACNC,OAAQ,GACRF,SAAU,CACR,CACED,KAAM,QACNO,SACE,+DAEJ,CACEP,KAAM,QACNO,SACE,4DAEJ,CACEP,KAAM,QACNO,SACE,4DAEJ,CACEP,KAAM,QACNO,SACE,wEA6aVE,2BA1DiC,CACjC,CACEP,KAAM,WACNQ,OAAQ,CACN,CAAEJ,KAAM,eACR,CACEA,KAAM,sBACNK,OAAQ,CACNC,MAAO,CACLN,KAAM,cACNO,QAAQ,EACRC,OAAQ,CACNC,IAAK,MAIXC,WAAY,CACVC,GAAI,CACFX,KAAM,aACNO,QAAQ,EACRF,OAAQ,CACNO,KAAM,CACJZ,KAAM,OACNO,QAAQ,EACRC,OAAQ,CACNI,KAAM,cAStB,CACEhB,KAAM,OACNQ,OAAQ,CACN,CAAEJ,KAAM,QACR,CACEA,KAAM,aACNK,OAAQ,CACNO,KAAM,CACJZ,KAAM,OACNO,QAAQ,EACRC,OAAQ,CACNI,KAAM,c,iCC1iBLC,EA9dH,WAAO,IAAD,EACwCjF,IAAMC,SAC5DyD,EAAYG,sBAFE,mBACTnE,EADS,KAIVwF,GAJU,KAIEvE,oBAJF,EAMMV,qBANN,mBAMTG,EANS,KAMJC,EANI,OAOkBJ,qBAPlB,mBAOTkF,EAPS,KAOEC,EAPF,OAQMnF,oBAAS,GARf,mBAQToF,EARS,KAQJC,EARI,OASkBrF,qBATlB,mBASTC,EATS,KASEC,EATF,OAUwBF,oBAAS,GAVjC,mBAUKsF,GAVL,WAwBhB,SAASC,EAAQC,EAAaC,GAG5BrE,IAAQsE,WAAWC,iBAAiB,SACpCvE,IAAQsE,WAAWC,iBAAiB,OACpCvE,IAAQsE,WAAWC,iBAAiB,UACpCvE,IAAQsE,WAAWC,iBAAiB,kBACpCvE,IAAQsE,WAAWC,iBAAiB,kBAEpC,IAAIC,EAAU,SAAU3B,GACtB,OAAO4B,MAAMC,UAAUC,OAAS9B,EAAO,KAEzCuB,EAAYQ,YAAYP,EAAc,QACpCD,EAAYS,qBAAqBL,IAGnCA,EAAU,SAAU3B,GAClB,OAAOiC,QAAQC,IAAIL,UAAUC,OAAS9B,EAAO,KAE/CuB,EAAYQ,YAAYP,EAAc,MACpCD,EAAYS,qBAAqBL,IAGnCA,EAAU,SAAU3B,GAClB,OAAOmC,OAAOnC,IAEhBuB,EAAYQ,YAAYP,EAAc,SACpCD,EAAYS,qBAAqBL,IAEnCA,EAAU,SAAUS,GAElB,OADAf,GAAgB,GACTrF,EAAUqG,eAAeD,IAElCb,EAAYQ,YAAYP,EAAc,iBACpCD,EAAYS,qBAAqBL,IAEnCA,EAAU,WAGR,OAFAP,GAAO,GACPJ,EAAUrE,QAAQ2F,UAAW,EACtBtG,EAAUqG,eAAe,SAElCd,EAAYQ,YAAYP,EAAc,iBACpCD,EAAYS,qBAAqBL,IAEnCA,EAAUJ,EAAYgB,qBACpB,SAAUC,EAAe5D,GAEvBqD,QAAQC,IAAItD,GACZN,WAAWM,EAAU4D,MAEzBjB,EAAYQ,YAAYP,EAAc,iBAAkBG,GAMxDA,EAAU,SAAUc,GAClB,IACEC,OAAOC,mBAAmBC,YACxBC,KAAKC,UAAU,CACbC,QAAS,OACTC,KAAM,KAAOP,KAInB,MAAOQ,GACLrB,MAAMqB,KAGV1B,EAAYQ,YAAYP,EAAc,QACpCD,EAAYS,qBAAqBL,IAEnCA,EAAU,SAAUc,GAClB,IACEC,OAAOC,mBAAmBC,YACxBC,KAAKC,UAAU,CACbC,QAAS,OACTC,KAAM,KAAOP,KAInB,MAAOQ,GACLrB,MAAMqB,KAGV1B,EAAYQ,YAAYP,EAAc,OACpCD,EAAYS,qBAAqBL,IAEnCA,EAAU,SAAUc,GAClB,IACEC,OAAOC,mBAAmBC,YACxBC,KAAKC,UAAU,CACbC,QAAS,OACTC,KAAM,KAAOP,KAInB,MAAOQ,GACLrB,MAAMqB,KAGV1B,EAAYQ,YAAYP,EAAc,OACpCD,EAAYS,qBAAqBL,IA5GrCxE,IAAQ+F,UAAUC,GAClBhG,IAAQsE,WAAW2B,iBAAmB,wBAEtCjG,IAAQsE,WAAWC,iBAAiB,kBACpCvE,IAAQsE,WAAW4B,mBAAqB,kHA4GxCX,OAAOY,iBAAiB,WAAW,SAAUC,GAC3C,IAAIC,EAAMX,KAAKY,MAAMF,EAAMG,MAKP,QAAhBF,EAAIT,UACNd,QAAQC,IAAI,eACZhB,EAAasC,EAAIR,UAOrBN,OAAOpE,YAAW,WACX2C,GACHC,EAAa1B,EAAYC,eAE1B,KAQH3D,IAAMY,WAAU,WA6Cd,IAAMiH,EAAQ,CACZ,KAAQ,QACR,SAAY,+BACZ,MAAS,CACP,CACE,KAAQ,eAEV,CACE,KAAQ,eACR,KAAQ,QACR,MAAS,EACT,UAAa,IAGjB,cAAgB,EAChB,kBAAqB,KACrB,cAAiB,KACjB,OAAU,GACV,QAAW,4GACX,QAAW,IAEbxG,IAAQyG,OAAR,MAA0B,CACxBC,KAAM,WACJC,KAAKC,SAASJ,KAKlBxG,IAAQsE,WAAR,MAA8B,SAAUuC,GAItC,MADW,SAFQA,EAAMC,cAAc,SAEF,OAMvC,IAAMC,EAAO,CACX,KAAQ,OACR,SAAY,sCACZ,MAAS,CACP,CACE,KAAQ,eAEV,CACE,KAAQ,eACR,KAAQ,OACR,MAAS,EACT,UAAa,IAGjB,cAAgB,EAChB,kBAAqB,KACrB,cAAiB,KACjB,OAAU,EACV,QAAW,oGACX,QAAW,IAEb/G,IAAQyG,OAAR,KAAyB,CACvBC,KAAM,WACJC,KAAKC,SAASG,KAKlB/G,IAAQsE,WAAR,KAA6B,SAAUuC,GAIrC,MADW,QAFOA,EAAMC,cAAc,QAEH,OAMrC,IAAME,EAAO,CACX,KAAQ,OACR,SAAY,wCACZ,MAAS,CACP,CACE,KAAQ,eAEV,CACE,KAAQ,eACR,KAAQ,OACR,MAAS,EACT,UAAa,IAGjB,cAAgB,EAChB,kBAAqB,KACrB,cAAiB,KACjB,OAAU,EACV,QAAW,sGACX,QAAW,IAEbhH,IAAQyG,OAAR,KAAyB,CACvBC,KAAM,WACJC,KAAKC,SAASI,KAKlBhH,IAAQsE,WAAR,KAA6B,SAAUuC,GAIrC,MADW,QAFOA,EAAMC,cAAc,QAEH,SAKpC,IAIH,IAAMG,EAAM,CACV,KAAQ,MACR,SAAY,gCACZ,MAAS,CAAC,CACRlE,KAAM,eACNJ,KAAM,cACNuE,IAAK,EACLC,IAAK,IACLC,MAAO,IAET,kBAAqB,KACrB,cAAiB,KACjB,OAAU,IACV,QAAW,yGACX,QAAW,IAEbpH,IAAQyG,OAAR,IAAwB,CACtBC,KAAM,WACJC,KAAKC,SAASK,KAKlBjH,IAAQsE,WAAR,IAA4B,SAAUuC,GAGpC,MADW,kBADGQ,OAAOR,EAAMC,cAAc,gBACA,QAI3C,IAAMvI,EAAoBI,IAAMmB,aAAY,SAACjB,GAC3CA,EAAUyI,uBAAuB,YAAY,WAC3C,IACE/B,OAAOC,mBAAmBC,YACxBC,KAAKC,UAAU,CACbC,QAAS,OACTC,KAAM9G,KAIZ,MAAO+G,GACLrB,MAAMqB,GAERrB,MAAM,wEAERK,QAAQC,IAAI/E,IAAQsE,WAAWiD,gBAAgB1I,IAC/CC,EAAaD,KACZ,IAEGoD,EAActD,IAAMmB,aAAY,SAACuB,GACrCyD,QAAQC,IAAI1D,GACZrC,EAAOqC,KACN,IAyDH,OACE,qCACGyC,GAAa,gCAEZ,qBAAK9B,UAAU,mBAAf,SACE,cAACwF,EAAA,EAAD,CAAQC,QA5DG,SAAC5F,GAKlB,IAAI6F,EAAUC,SAASC,uBAAuB,qBAAqB,GACrC,MAA1BF,EAAQG,MAAMC,SAEhBJ,EAAQG,MAAMC,QAAU,IACxB3G,YAAW,WACTuG,EAAQG,MAAME,QAAU,QACxBxC,OAAOyC,cAAc,IAAIC,MAAM,aAC9B,OAGHP,EAAQG,MAAMC,QAAU,IACxB3G,YAAW,WACTuG,EAAQG,MAAME,QAAU,OACxBxC,OAAOyC,cAAc,IAAIC,MAAM,aAC9B,OAyC8BC,QAAQ,oDAAoDlG,UAAU,aAAnG,oBAEF,qBAAKA,UAAU,cAAf,SACE,cAACwF,EAAA,EAAD,CAAQrJ,IAAK0F,EAAWsB,UAAU,EAAOsC,QAxC/B,SAAC5F,GAEjBoC,GAAO,GACPJ,EAAUrE,QAAQ2F,UAAW,EAC7BL,QAAQC,IAAIlB,EAAUrE,QAAQ2F,UAC9B,IAAIgD,EAAOnI,IAAQsE,WAAWiD,gBAAgB1I,GAC9CsJ,EAAO,yBAA2BA,EAAO,0BACzC,IAAIC,EAAgB,IAAIC,IAAYF,EAAMhE,IAC1C,SAASmE,IACHF,EAAcG,QAiBhBhD,OAAOpE,WAAWmH,EAAU,GAGhCA,IAWmEJ,QAAQ,kBAAkBlG,UAAU,+CAAjG,SAAiJgC,EAAM,aAAe,cAIzKF,GAAa,cAAC,EAAD,CACZzF,qBAAsBA,EACtBC,uBAAwB,CAOtBkK,KAAM,CACJC,UAAU,EACVC,OAAO,EACPC,WAAY,EACZC,SAAU,EACVC,SAAU,GACVC,WAAY,IACZC,OAAO,GAETC,kBAAkB,EAClBC,gBAAiB,OAGnB7K,WAAY0F,EACZ9B,UAAU,cACVzD,kBAAmBA,EACnB0D,YAAaA,EACbzD,iBAAkB,kBAAMiG,MAAM,yDAC9ByE,SA1cW,KA8cb,sBAAKlH,UAAU,iBAAf,WAEK8B,GAAa,cAACqF,EAAA,EAAD,CAASC,UAAU,SAASlB,QAAQ,YAEpD,qBAAKL,MAAO,CAAEwB,SAAU,SAAxB,0CC1dYC,QACW,cAA7B/D,OAAOgE,SAASC,UAEe,UAA7BjE,OAAOgE,SAASC,UAEhBjE,OAAOgE,SAASC,SAASC,MACvB,2D,YCTNlE,OAAOY,iBAAiB,QAAQ,WAC5B,IAAMuD,EAAS/K,IAAMgL,cAAc/F,GACnCgG,IAASC,OAAOH,EAAQ/B,SAASmC,eAAe,YDsH9C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,MAAK,SAAAC,GACjCA,EAAaC,kB","file":"static/js/main.71a2f77a.chunk.js","sourcesContent":["import React from \"react\";\nimport Blockly from \"blockly\";\n\nimport debounce from \"./debounce\";\nimport Theme from '@blockly/theme-modern';\n\nfunction importFromXml(xml, workspace, onImportXmlError) {\n  try {\n    Blockly.Xml.domToWorkspace(Blockly.Xml.textToDom(xml), workspace);\n    return true;\n  } catch (e) {\n    if (onImportXmlError) {\n      onImportXmlError(e);\n    }\n    return false;\n  }\n}\n\nconst useBlocklyWorkspace = ({\n  ref,\n  initialXml,\n  toolboxConfiguration,\n  workspaceConfiguration,\n  onWorkspaceChange,\n  onImportXmlError,\n  onInject,\n  onDispose,\n}) => {\n  const [workspace, setWorkspace] = React.useState(null);\n  const [xml, setXml] = React.useState(initialXml);\n  const [didInitialImport, setDidInitialImport] = React.useState(false);\n  const [didHandleNewWorkspace, setDidHandleNewWorkspace] =\n    React.useState(false);\n\n  // we explicitly don't want to recreate the workspace when the configuration changes\n  // so, we'll keep it in a ref and update as necessary in an effect hook\n  const workspaceConfigurationRef = React.useRef(workspaceConfiguration);\n  React.useEffect(() => {\n    workspaceConfigurationRef.current = workspaceConfiguration;\n  }, [workspaceConfiguration]);\n\n  const toolboxConfigurationRef = React.useRef(toolboxConfiguration);\n  React.useEffect(() => {\n    toolboxConfigurationRef.current = toolboxConfiguration;\n    if (toolboxConfiguration && workspace) {\n      workspace.updateToolbox(toolboxConfiguration);\n    }\n  }, [toolboxConfiguration, workspace]);\n\n  const onInjectRef = React.useRef(onInject);\n  const onDisposeRef = React.useRef(onDispose);\n  React.useEffect(() => {\n    onInjectRef.current = onInject;\n  }, [onInject]);\n  React.useEffect(() => {\n    onDisposeRef.current = onDispose;\n  }, [onDispose]);\n\n  const handleWorkspaceChanged = React.useCallback(\n    (newWorkspace) => {\n      if (onWorkspaceChange) {\n        onWorkspaceChange(newWorkspace);\n      }\n    },\n    [onWorkspaceChange]\n  );\n\n  // Workspace creation\n  React.useEffect(() => {\n    const newWorkspace = Blockly.inject(ref.current, {\n      ...workspaceConfigurationRef.current,\n      toolbox: toolboxConfigurationRef.current,\n      theme: Theme,\n    });\n    Blockly.Flyout.prototype.MARGIN = 20\n    setWorkspace(newWorkspace);\n    setDidInitialImport(false); // force a re-import if we recreate the workspace\n    setDidHandleNewWorkspace(false); // Singal that a workspace change event needs to be sent.\n\n    if (onInjectRef.current) {\n      onInjectRef.current(newWorkspace);\n    }\n\n    const onDisposeFunction = onDisposeRef.current;\n\n    // Dispose of the workspace when our div ref goes away (Equivalent to didComponentUnmount)\n    return () => {\n      newWorkspace.dispose();\n\n      if (onDisposeFunction) {\n        onDisposeFunction(newWorkspace);\n      }\n    };\n  }, [ref]);\n\n  // Send a workspace change event when the workspace is created\n  React.useEffect(() => {\n    if (workspace && !didHandleNewWorkspace) {\n      handleWorkspaceChanged(workspace);\n    }\n  }, [handleWorkspaceChanged, didHandleNewWorkspace, workspace]);\n\n  // Workspace change listener\n  React.useEffect(() => {\n    if (workspace == null) {\n      return undefined;\n    }\n\n    const listener = () => {\n      handleWorkspaceChanged(workspace);\n    };\n    workspace.addChangeListener(listener);\n    return () => {\n      workspace.removeChangeListener(listener);\n    };\n  }, [workspace, handleWorkspaceChanged]);\n\n  // xmlDidChange callback\n  React.useEffect(() => {\n    if (workspace == null) {\n      return undefined;\n    }\n\n    const [callback, cancel] = debounce(() => {\n      const newXml = Blockly.Xml.domToText(\n        Blockly.Xml.workspaceToDom(workspace)\n      );\n      if (newXml === xml) {\n        return;\n      }\n\n      setXml(newXml);\n    }, 200);\n\n    workspace.addChangeListener(callback);\n\n    return () => {\n      workspace.removeChangeListener(callback);\n      cancel();\n    };\n  }, [workspace, xml]);\n\n  // Initial Xml Changes\n  React.useEffect(() => {\n    if (xml && workspace && !didInitialImport) {\n      const success = importFromXml(xml, workspace, onImportXmlError);\n      if (!success) {\n        setXml(null);\n      }\n      setDidInitialImport(true);\n    }\n  }, [xml, workspace, didInitialImport, onImportXmlError]);\n\n  return { workspace, xml };\n};\n\nexport default useBlocklyWorkspace;\n","export default function debounce(func, wait) {\n  let timeout = null;\n  let later = null;\n\n  const debouncedFunction = (...args) => {\n    later = () => {\n      timeout = null;\n      func(...args);\n    };\n    clearTimeout(timeout);\n    timeout = setTimeout(later, wait);\n  };\n\n  const cancel = () => {\n    if (timeout !== null) {\n      clearTimeout(timeout);\n      later();\n    }\n  };\n\n  return [debouncedFunction, cancel];\n}\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport useBlocklyWorkspace from \"./useBlocklyWorkspace\";\n\nconst propTypes = {\n  initialXml: PropTypes.string,\n  toolboxConfiguration: PropTypes.object, // eslint-disable-line react/forbid-prop-types\n  workspaceConfiguration: PropTypes.object, // eslint-disable-line react/forbid-prop-types\n  className: PropTypes.string,\n  onWorkspaceChange: PropTypes.func,\n  onImportXmlError: PropTypes.func,\n  onXmlChange: PropTypes.func,\n  onInject: PropTypes.func,\n  onDispose: PropTypes.func,\n};\n\nconst defaultProps = {\n  initialXml: null,\n  toolboxConfiguration: null,\n  workspaceConfiguration: null,\n  className: null,\n  onWorkspaceChange: null,\n  onImportXmlError: null,\n  onXmlChange: null,\n  onInject: null,\n  onDispose: null,\n};\n\nfunction BlocklyWorkspace({\n  initialXml,\n  toolboxConfiguration,\n  workspaceConfiguration,\n  className,\n  onWorkspaceChange,\n  onXmlChange,\n  onImportXmlError,\n  onInject,\n  onDispose,\n}) {\n  const editorDiv = React.useRef(null);\n  const { xml } = useBlocklyWorkspace({\n    ref: editorDiv,\n    initialXml,\n    toolboxConfiguration,\n    workspaceConfiguration,\n    onWorkspaceChange,\n    onImportXmlError,\n    onInject,\n    onDispose,\n  });\n  const onXmlChangeRef = React.useRef(onXmlChange);\n  React.useEffect(() => {\n    onXmlChangeRef.current = onXmlChange;\n  }, [onXmlChange]);\n  React.useEffect(() => {\n    if (onXmlChangeRef.current && xml) {\n      onXmlChangeRef.current(xml);\n    }\n  }, [xml]);\n\n  return <div className={className} ref={editorDiv} />;\n}\n\nBlocklyWorkspace.propTypes = propTypes;\nBlocklyWorkspace.defaultProps = defaultProps;\n\nexport default BlocklyWorkspace;\n","const INITIAL_XML =\n  '<xml xmlns=\"https://developers.google.com/blockly/xml\"><block type=\"text_print\" id=\"/.o;xPY6dEFHu6(|-Ny-\" x=\"248\" y=\"79\"><value name=\"TEXT\"><shadow type=\"text\" id=\"At$Jca1#A-%cmtwX^lF(\"><field name=\"TEXT\">Hello</field></shadow></value></block></xml>';\n\nconst INITIAL_TOOLBOX_JSON = {\n  kind: \"categoryToolbox\",\n  contents: [\n    {\n      kind: \"category\",\n      name: \"Quản lý tệp\",\n      colour: 160,\n      contents: [\n        {\n          kind: \"button\",\n          text: \"Lưu chương trình\",\n          callbackKey: \"saveFile\",\n        },\n      ],\n    },\n    { kind: \"sep\" },\n    {\n      kind: \"category\",\n      name: \"Logic\",\n      colour: 210,\n      contents: [\n        {\n          kind: \"block\",\n          type: \"controls_if\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '<block type=\"logic_compare\"><field name=\"OP\">EQ</field></block>',\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '<block type=\"logic_operation\"><field name=\"OP\">AND</field></block>',\n        },\n        {\n          kind: \"block\",\n          type: \"logic_negate\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '<block type=\"logic_boolean\"><field name=\"BOOL\">TRUE</field></block>',\n        },\n        {\n          kind: \"block\",\n          type: \"logic_null\",\n        },\n        {\n          kind: \"block\",\n          type: \"logic_ternary\",\n        },\n      ],\n    },\n    {\n      kind: \"category\",\n      name: \"Vòng lặp\",\n      colour: 120,\n      contents: [\n        {\n          kind: \"block\",\n          blockxml:\n            '<block type=\"controls_repeat_ext\">\\n' +\n            '      <value name=\"TIMES\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">10</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"controls_whileUntil\">\\n' +\n            '      <field name=\"MODE\">WHILE</field>\\n' +\n            \"    </block>\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"controls_for\">\\n' +\n            '      <field name=\"VAR\" id=\"C(8;cYCF}~vSgkxzJ+{O\" variabletype=\"\">i</field>\\n' +\n            '      <value name=\"FROM\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">1</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            '      <value name=\"TO\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">10</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            '      <value name=\"BY\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">1</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"controls_forEach\">\\n' +\n            '      <field name=\"VAR\" id=\"Cg!CSk/ZJo2XQN3=VVrz\" variabletype=\"\">j</field>\\n' +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"controls_flow_statements\">\\n' +\n            '      <field name=\"FLOW\">BREAK</field>\\n' +\n            \"    </block>\\n\",\n        },\n      ],\n    },\n    {\n      kind: \"category\",\n      name: \"Phép toán\",\n      colour: 230,\n      contents: [\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_round\">\\n' +\n            '      <field name=\"OP\">ROUND</field>\\n' +\n            '      <value name=\"NUM\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">3.1</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_number\">\\n' +\n            '      <field name=\"NUM\">0</field>\\n' +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_single\">\\n' +\n            '      <field name=\"OP\">ROOT</field>\\n' +\n            '      <value name=\"NUM\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">9</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_trig\">\\n' +\n            '      <field name=\"OP\">SIN</field>\\n' +\n            '      <value name=\"NUM\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">45</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_constant\">\\n' +\n            '      <field name=\"CONSTANT\">PI</field>\\n' +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_number_property\">\\n' +\n            '      <mutation divisor_input=\"false\"></mutation>\\n' +\n            '      <field name=\"PROPERTY\">EVEN</field>\\n' +\n            '      <value name=\"NUMBER_TO_CHECK\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">0</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_arithmetic\">\\n' +\n            '      <field name=\"OP\">ADD</field>\\n' +\n            '      <value name=\"A\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">1</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            '      <value name=\"B\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">1</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_on_list\">\\n' +\n            '      <mutation op=\"SUM\"></mutation>\\n' +\n            '      <field name=\"OP\">SUM</field>\\n' +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_modulo\">\\n' +\n            '      <value name=\"DIVIDEND\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">64</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            '      <value name=\"DIVISOR\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">10</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_constrain\">\\n' +\n            '      <value name=\"VALUE\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">50</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            '      <value name=\"LOW\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">1</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            '      <value name=\"HIGH\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">100</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"math_random_int\">\\n' +\n            '      <value name=\"FROM\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">1</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            '      <value name=\"TO\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">100</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          type: \"math_random_float\",\n        },\n      ],\n    },\n    {\n      kind: \"category\",\n      name: \"Văn bản\",\n      colour: 160,\n      contents: [\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_charAt\">\\n' +\n            '      <mutation at=\"true\"></mutation>\\n' +\n            '      <field name=\"WHERE\">FROM_START</field>\\n' +\n            '      <value name=\"VALUE\">\\n' +\n            '        <block type=\"variables_get\">\\n' +\n            '          <field name=\"VAR\" id=\"q@$ZF(L?Zo/z`d{o.Bp!\" variabletype=\"\">text</field>\\n' +\n            \"        </block>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text\">\\n' +\n            '      <field name=\"TEXT\"></field>\\n' +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_append\">\\n' +\n            '      <field name=\"VAR\" id=\":};P,s[*|I8+L^-.EbRi\" variabletype=\"\">item</field>\\n' +\n            '      <value name=\"TEXT\">\\n' +\n            '        <shadow type=\"text\">\\n' +\n            '          <field name=\"TEXT\"></field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_length\">\\n' +\n            '      <value name=\"VALUE\">\\n' +\n            '        <shadow type=\"text\">\\n' +\n            '          <field name=\"TEXT\">abc</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_isEmpty\">\\n' +\n            '      <value name=\"VALUE\">\\n' +\n            '        <shadow type=\"text\">\\n' +\n            '          <field name=\"TEXT\"></field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_indexOf\">\\n' +\n            '      <field name=\"END\">FIRST</field>\\n' +\n            '      <value name=\"VALUE\">\\n' +\n            '        <block type=\"variables_get\">\\n' +\n            '          <field name=\"VAR\" id=\"q@$ZF(L?Zo/z`d{o.Bp!\" variabletype=\"\">text</field>\\n' +\n            \"        </block>\\n\" +\n            \"      </value>\\n\" +\n            '      <value name=\"FIND\">\\n' +\n            '        <shadow type=\"text\">\\n' +\n            '          <field name=\"TEXT\">abc</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_join\">\\n' +\n            '      <mutation items=\"2\"></mutation>\\n' +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_getSubstring\">\\n' +\n            '      <mutation at1=\"true\" at2=\"true\"></mutation>\\n' +\n            '      <field name=\"WHERE1\">FROM_START</field>\\n' +\n            '      <field name=\"WHERE2\">FROM_START</field>\\n' +\n            '      <value name=\"STRING\">\\n' +\n            '        <block type=\"variables_get\">\\n' +\n            '          <field name=\"VAR\" id=\"q@$ZF(L?Zo/z`d{o.Bp!\" variabletype=\"\">text</field>\\n' +\n            \"        </block>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_changeCase\">\\n' +\n            '      <field name=\"CASE\">UPPERCASE</field>\\n' +\n            '      <value name=\"TEXT\">\\n' +\n            '        <shadow type=\"text\">\\n' +\n            '          <field name=\"TEXT\">abc</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_trim\">\\n' +\n            '      <field name=\"MODE\">BOTH</field>\\n' +\n            '      <value name=\"TEXT\">\\n' +\n            '        <shadow type=\"text\">\\n' +\n            '          <field name=\"TEXT\">abc</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_print\">\\n' +\n            '      <value name=\"TEXT\">\\n' +\n            '        <shadow type=\"text\">\\n' +\n            '          <field name=\"TEXT\">abc</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"text_prompt_ext\">\\n' +\n            '      <mutation type=\"TEXT\"></mutation>\\n' +\n            '      <field name=\"TYPE\">TEXT</field>\\n' +\n            '      <value name=\"TEXT\">\\n' +\n            '        <shadow type=\"text\">\\n' +\n            '          <field name=\"TEXT\">abc</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n      ],\n    },\n    {\n      kind: \"category\",\n      name: \"Danh sách\",\n      colour: 259,\n      contents: [\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"lists_indexOf\">\\n' +\n            '      <field name=\"END\">FIRST</field>\\n' +\n            '      <value name=\"VALUE\">\\n' +\n            '        <block type=\"variables_get\">\\n' +\n            '          <field name=\"VAR\" id=\"e`(L;x,.j[[XN`F33Q5.\" variabletype=\"\">list</field>\\n' +\n            \"        </block>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"lists_create_with\">\\n' +\n            '      <mutation items=\"0\"></mutation>\\n' +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"lists_repeat\">\\n' +\n            '      <value name=\"NUM\">\\n' +\n            '        <shadow type=\"math_number\">\\n' +\n            '          <field name=\"NUM\">5</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          type: \"lists_length\",\n        },\n        {\n          kind: \"block\",\n          type: \"lists_isEmpty\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"lists_create_with\">\\n' +\n            '      <mutation items=\"3\"></mutation>\\n' +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"lists_getIndex\">\\n' +\n            '      <mutation statement=\"false\" at=\"true\"></mutation>\\n' +\n            '      <field name=\"MODE\">GET</field>\\n' +\n            '      <field name=\"WHERE\">FROM_START</field>\\n' +\n            '      <value name=\"VALUE\">\\n' +\n            '        <block type=\"variables_get\">\\n' +\n            '          <field name=\"VAR\" id=\"e`(L;x,.j[[XN`F33Q5.\" variabletype=\"\">list</field>\\n' +\n            \"        </block>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"lists_setIndex\">\\n' +\n            '      <mutation at=\"true\"></mutation>\\n' +\n            '      <field name=\"MODE\">SET</field>\\n' +\n            '      <field name=\"WHERE\">FROM_START</field>\\n' +\n            '      <value name=\"LIST\">\\n' +\n            '        <block type=\"variables_get\">\\n' +\n            '          <field name=\"VAR\" id=\"e`(L;x,.j[[XN`F33Q5.\" variabletype=\"\">list</field>\\n' +\n            \"        </block>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"lists_getSublist\">\\n' +\n            '      <mutation at1=\"true\" at2=\"true\"></mutation>\\n' +\n            '      <field name=\"WHERE1\">FROM_START</field>\\n' +\n            '      <field name=\"WHERE2\">FROM_START</field>\\n' +\n            '      <value name=\"LIST\">\\n' +\n            '        <block type=\"variables_get\">\\n' +\n            '          <field name=\"VAR\" id=\"e`(L;x,.j[[XN`F33Q5.\" variabletype=\"\">list</field>\\n' +\n            \"        </block>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"lists_split\">\\n' +\n            '      <mutation mode=\"SPLIT\"></mutation>\\n' +\n            '      <field name=\"MODE\">SPLIT</field>\\n' +\n            '      <value name=\"DELIM\">\\n' +\n            '        <shadow type=\"text\">\\n' +\n            '          <field name=\"TEXT\">,</field>\\n' +\n            \"        </shadow>\\n\" +\n            \"      </value>\\n\" +\n            \"    </block>\\n\",\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '    <block type=\"lists_sort\">\\n' +\n            '      <field name=\"TYPE\">NUMERIC</field>\\n' +\n            '      <field name=\"DIRECTION\">1</field>\\n' +\n            \"    </block>\\n\",\n        },\n      ],\n    },\n    /*\n        {\n          kind: \"category\",\n          name: \"Colour\",\n          colour: 19,\n          contents: [\n            {\n              kind: \"block\",\n              blockxml:\n                '    <block type=\"colour_picker\">\\n' +\n                '      <field name=\"COLOUR\">#ff0000</field>\\n' +\n                \"    </block>\\n\",\n            },\n            {\n              kind: \"block\",\n              type: \"colour_random\",\n            },\n            {\n              kind: \"block\",\n              blockxml:\n                '    <block type=\"colour_rgb\">\\n' +\n                '      <value name=\"RED\">\\n' +\n                '        <shadow type=\"math_number\">\\n' +\n                '          <field name=\"NUM\">100</field>\\n' +\n                \"        </shadow>\\n\" +\n                \"      </value>\\n\" +\n                '      <value name=\"GREEN\">\\n' +\n                '        <shadow type=\"math_number\">\\n' +\n                '          <field name=\"NUM\">50</field>\\n' +\n                \"        </shadow>\\n\" +\n                \"      </value>\\n\" +\n                '      <value name=\"BLUE\">\\n' +\n                '        <shadow type=\"math_number\">\\n' +\n                '          <field name=\"NUM\">0</field>\\n' +\n                \"        </shadow>\\n\" +\n                \"      </value>\\n\" +\n                \"    </block>\\n\",\n            },\n            {\n              kind: \"block\",\n              blockxml:\n                '    <block type=\"colour_blend\">\\n' +\n                '      <value name=\"COLOUR1\">\\n' +\n                '        <shadow type=\"colour_picker\">\\n' +\n                '          <field name=\"COLOUR\">#ff0000</field>\\n' +\n                \"        </shadow>\\n\" +\n                \"      </value>\\n\" +\n                '      <value name=\"COLOUR2\">\\n' +\n                '        <shadow type=\"colour_picker\">\\n' +\n                '          <field name=\"COLOUR\">#3333ff</field>\\n' +\n                \"        </shadow>\\n\" +\n                \"      </value>\\n\" +\n                '      <value name=\"RATIO\">\\n' +\n                '        <shadow type=\"math_number\">\\n' +\n                '          <field name=\"NUM\">0.5</field>\\n' +\n                \"        </shadow>\\n\" +\n                \"      </value>\\n\" +\n                \"    </block>\\n\",\n            },\n          ],\n        }, \n    */\n    { kind: \"sep\" },\n    {\n      kind: \"category\",\n      name: \"Biến\",\n      custom: \"VARIABLE\",\n      colour: 330,\n    },\n    {\n      kind: \"category\",\n      name: \"Hàm\",\n      custom: \"PROCEDURE\",\n      colour: 290,\n    },\n    { kind: \"sep\" },\n    {\n      kind: \"category\",\n      name: \"Nhóm Điều Khiển\",\n      colour: 19,\n      contents: [\n        {\n          kind: \"block\",\n          blockxml:\n            '<block type=\"thang\"><field name=\"THANG\">100</field></block>',\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '<block type=\"trai\"><field name=\"TRAI\">90</field></block>',\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '<block type=\"phai\"><field name=\"PHAI\">90</field></block>',\n        },\n        {\n          kind: \"block\",\n          blockxml:\n            '<block type=\"doi\"><field name=\"MILISECONDS\">1000</field></block>',\n        },\n      ],\n    },\n  ],\n};\n\nconst INITIAL_TOOLBOX_XML =\n  '<xml xmlns=\"http://www.w3.org/1999/xhtml\" id=\"toolbox\" style=\"display: none;\">\\n' +\n  '  <category name=\"Logic\" colour=\"#5C81A6\">\\n' +\n  '    <block type=\"controls_if\"></block>\\n' +\n  '    <block type=\"logic_compare\">\\n' +\n  '      <field name=\"OP\">EQ</field>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"logic_operation\">\\n' +\n  '      <field name=\"OP\">AND</field>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"logic_negate\"></block>\\n' +\n  '    <block type=\"logic_boolean\">\\n' +\n  '      <field name=\"BOOL\">TRUE</field>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"logic_null\"></block>\\n' +\n  '    <block type=\"logic_ternary\"></block>\\n' +\n  \"  </category>\\n\" +\n  '  <category name=\"Loops\" colour=\"#5CA65C\">\\n' +\n  '    <block type=\"controls_repeat_ext\">\\n' +\n  '      <value name=\"TIMES\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">10</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"controls_whileUntil\">\\n' +\n  '      <field name=\"MODE\">WHILE</field>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"controls_for\">\\n' +\n  '      <field name=\"VAR\" id=\"C(8;cYCF}~vSgkxzJ+{O\" variabletype=\"\">i</field>\\n' +\n  '      <value name=\"FROM\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">1</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"TO\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">10</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"BY\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">1</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"controls_forEach\">\\n' +\n  '      <field name=\"VAR\" id=\"Cg!CSk/ZJo2XQN3=VVrz\" variabletype=\"\">j</field>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"controls_flow_statements\">\\n' +\n  '      <field name=\"FLOW\">BREAK</field>\\n' +\n  \"    </block>\\n\" +\n  \"  </category>\\n\" +\n  '  <category name=\"Math\" colour=\"#5C68A6\">\\n' +\n  '    <block type=\"math_round\">\\n' +\n  '      <field name=\"OP\">ROUND</field>\\n' +\n  '      <value name=\"NUM\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">3.1</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"math_number\">\\n' +\n  '      <field name=\"NUM\">0</field>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"math_single\">\\n' +\n  '      <field name=\"OP\">ROOT</field>\\n' +\n  '      <value name=\"NUM\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">9</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"math_trig\">\\n' +\n  '      <field name=\"OP\">SIN</field>\\n' +\n  '      <value name=\"NUM\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">45</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"math_constant\">\\n' +\n  '      <field name=\"CONSTANT\">PI</field>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"math_number_property\">\\n' +\n  '      <mutation divisor_input=\"false\"></mutation>\\n' +\n  '      <field name=\"PROPERTY\">EVEN</field>\\n' +\n  '      <value name=\"NUMBER_TO_CHECK\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">0</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"math_arithmetic\">\\n' +\n  '      <field name=\"OP\">ADD</field>\\n' +\n  '      <value name=\"A\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">1</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"B\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">1</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"math_on_list\">\\n' +\n  '      <mutation op=\"SUM\"></mutation>\\n' +\n  '      <field name=\"OP\">SUM</field>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"math_modulo\">\\n' +\n  '      <value name=\"DIVIDEND\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">64</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"DIVISOR\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">10</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"math_constrain\">\\n' +\n  '      <value name=\"VALUE\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">50</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"LOW\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">1</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"HIGH\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">100</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"math_random_int\">\\n' +\n  '      <value name=\"FROM\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">1</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"TO\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">100</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"math_random_float\"></block>\\n' +\n  \"  </category>\\n\" +\n  '  <category name=\"Text\" colour=\"#5CA68D\">\\n' +\n  '    <block type=\"text_charAt\">\\n' +\n  '      <mutation at=\"true\"></mutation>\\n' +\n  '      <field name=\"WHERE\">FROM_START</field>\\n' +\n  '      <value name=\"VALUE\">\\n' +\n  '        <block type=\"variables_get\">\\n' +\n  '          <field name=\"VAR\" id=\"q@$ZF(L?Zo/z`d{o.Bp!\" variabletype=\"\">text</field>\\n' +\n  \"        </block>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"text\">\\n' +\n  '      <field name=\"TEXT\"></field>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"text_append\">\\n' +\n  '      <field name=\"VAR\" id=\":};P,s[*|I8+L^-.EbRi\" variabletype=\"\">item</field>\\n' +\n  '      <value name=\"TEXT\">\\n' +\n  '        <shadow type=\"text\">\\n' +\n  '          <field name=\"TEXT\"></field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"text_length\">\\n' +\n  '      <value name=\"VALUE\">\\n' +\n  '        <shadow type=\"text\">\\n' +\n  '          <field name=\"TEXT\">abc</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"text_isEmpty\">\\n' +\n  '      <value name=\"VALUE\">\\n' +\n  '        <shadow type=\"text\">\\n' +\n  '          <field name=\"TEXT\"></field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"text_indexOf\">\\n' +\n  '      <field name=\"END\">FIRST</field>\\n' +\n  '      <value name=\"VALUE\">\\n' +\n  '        <block type=\"variables_get\">\\n' +\n  '          <field name=\"VAR\" id=\"q@$ZF(L?Zo/z`d{o.Bp!\" variabletype=\"\">text</field>\\n' +\n  \"        </block>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"FIND\">\\n' +\n  '        <shadow type=\"text\">\\n' +\n  '          <field name=\"TEXT\">abc</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"text_join\">\\n' +\n  '      <mutation items=\"2\"></mutation>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"text_getSubstring\">\\n' +\n  '      <mutation at1=\"true\" at2=\"true\"></mutation>\\n' +\n  '      <field name=\"WHERE1\">FROM_START</field>\\n' +\n  '      <field name=\"WHERE2\">FROM_START</field>\\n' +\n  '      <value name=\"STRING\">\\n' +\n  '        <block type=\"variables_get\">\\n' +\n  '          <field name=\"VAR\" id=\"q@$ZF(L?Zo/z`d{o.Bp!\" variabletype=\"\">text</field>\\n' +\n  \"        </block>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"text_changeCase\">\\n' +\n  '      <field name=\"CASE\">UPPERCASE</field>\\n' +\n  '      <value name=\"TEXT\">\\n' +\n  '        <shadow type=\"text\">\\n' +\n  '          <field name=\"TEXT\">abc</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"text_trim\">\\n' +\n  '      <field name=\"MODE\">BOTH</field>\\n' +\n  '      <value name=\"TEXT\">\\n' +\n  '        <shadow type=\"text\">\\n' +\n  '          <field name=\"TEXT\">abc</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"text_print\">\\n' +\n  '      <value name=\"TEXT\">\\n' +\n  '        <shadow type=\"text\">\\n' +\n  '          <field name=\"TEXT\">abc</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"text_prompt_ext\">\\n' +\n  '      <mutation type=\"TEXT\"></mutation>\\n' +\n  '      <field name=\"TYPE\">TEXT</field>\\n' +\n  '      <value name=\"TEXT\">\\n' +\n  '        <shadow type=\"text\">\\n' +\n  '          <field name=\"TEXT\">abc</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  \"  </category>\\n\" +\n  '  <category name=\"Lists\" colour=\"#745CA6\">\\n' +\n  '    <block type=\"lists_indexOf\">\\n' +\n  '      <field name=\"END\">FIRST</field>\\n' +\n  '      <value name=\"VALUE\">\\n' +\n  '        <block type=\"variables_get\">\\n' +\n  '          <field name=\"VAR\" id=\"e`(L;x,.j[[XN`F33Q5.\" variabletype=\"\">list</field>\\n' +\n  \"        </block>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"lists_create_with\">\\n' +\n  '      <mutation items=\"0\"></mutation>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"lists_repeat\">\\n' +\n  '      <value name=\"NUM\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">5</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"lists_length\"></block>\\n' +\n  '    <block type=\"lists_isEmpty\"></block>\\n' +\n  '    <block type=\"lists_create_with\">\\n' +\n  '      <mutation items=\"3\"></mutation>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"lists_getIndex\">\\n' +\n  '      <mutation statement=\"false\" at=\"true\"></mutation>\\n' +\n  '      <field name=\"MODE\">GET</field>\\n' +\n  '      <field name=\"WHERE\">FROM_START</field>\\n' +\n  '      <value name=\"VALUE\">\\n' +\n  '        <block type=\"variables_get\">\\n' +\n  '          <field name=\"VAR\" id=\"e`(L;x,.j[[XN`F33Q5.\" variabletype=\"\">list</field>\\n' +\n  \"        </block>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"lists_setIndex\">\\n' +\n  '      <mutation at=\"true\"></mutation>\\n' +\n  '      <field name=\"MODE\">SET</field>\\n' +\n  '      <field name=\"WHERE\">FROM_START</field>\\n' +\n  '      <value name=\"LIST\">\\n' +\n  '        <block type=\"variables_get\">\\n' +\n  '          <field name=\"VAR\" id=\"e`(L;x,.j[[XN`F33Q5.\" variabletype=\"\">list</field>\\n' +\n  \"        </block>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"lists_getSublist\">\\n' +\n  '      <mutation at1=\"true\" at2=\"true\"></mutation>\\n' +\n  '      <field name=\"WHERE1\">FROM_START</field>\\n' +\n  '      <field name=\"WHERE2\">FROM_START</field>\\n' +\n  '      <value name=\"LIST\">\\n' +\n  '        <block type=\"variables_get\">\\n' +\n  '          <field name=\"VAR\" id=\"e`(L;x,.j[[XN`F33Q5.\" variabletype=\"\">list</field>\\n' +\n  \"        </block>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"lists_split\">\\n' +\n  '      <mutation mode=\"SPLIT\"></mutation>\\n' +\n  '      <field name=\"MODE\">SPLIT</field>\\n' +\n  '      <value name=\"DELIM\">\\n' +\n  '        <shadow type=\"text\">\\n' +\n  '          <field name=\"TEXT\">,</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"lists_sort\">\\n' +\n  '      <field name=\"TYPE\">NUMERIC</field>\\n' +\n  '      <field name=\"DIRECTION\">1</field>\\n' +\n  \"    </block>\\n\" +\n  \"  </category>\\n\" +\n  '  <category name=\"Colour\" colour=\"#A6745C\">\\n' +\n  '    <block type=\"colour_picker\">\\n' +\n  '      <field name=\"COLOUR\">#ff0000</field>\\n' +\n  \"    </block>\\n\" +\n  '    <block type=\"colour_random\"></block>\\n' +\n  '    <block type=\"colour_rgb\">\\n' +\n  '      <value name=\"RED\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">100</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"GREEN\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">50</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"BLUE\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">0</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  '    <block type=\"colour_blend\">\\n' +\n  '      <value name=\"COLOUR1\">\\n' +\n  '        <shadow type=\"colour_picker\">\\n' +\n  '          <field name=\"COLOUR\">#ff0000</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"COLOUR2\">\\n' +\n  '        <shadow type=\"colour_picker\">\\n' +\n  '          <field name=\"COLOUR\">#3333ff</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  '      <value name=\"RATIO\">\\n' +\n  '        <shadow type=\"math_number\">\\n' +\n  '          <field name=\"NUM\">0.5</field>\\n' +\n  \"        </shadow>\\n\" +\n  \"      </value>\\n\" +\n  \"    </block>\\n\" +\n  \"  </category>\\n\" +\n  \"  <sep></sep>\\n\" +\n  '  <category name=\"Custom Button\" colour=\"#A6745C\">\\n' +\n  '    <button text=\"A button\" callbackKey=\"myFirstButtonPressed\"></button>\\n' +\n  \"  </category>\\n\" +\n  '  <category name=\"Variables\" colour=\"#A65C81\" custom=\"VARIABLE\"></category>\\n' +\n  '  <category name=\"Functions\" colour=\"#9A5CA6\" custom=\"PROCEDURE\"></category>\\n' +\n  \"</xml>\";\n\n\nconst INITIAL_TOOLBOX_CATEGORIES = [\n  {\n    name: \"Controls\",\n    blocks: [\n      { type: \"controls_if\" },\n      {\n        type: \"controls_repeat_ext\",\n        values: {\n          TIMES: {\n            type: \"math_number\",\n            shadow: true,\n            fields: {\n              NUM: 10,\n            },\n          },\n        },\n        statements: {\n          DO: {\n            type: \"text_print\",\n            shadow: true,\n            values: {\n              TEXT: {\n                type: \"text\",\n                shadow: true,\n                fields: {\n                  TEXT: \"abc\",\n                },\n              },\n            },\n          },\n        },\n      },\n    ],\n  },\n  {\n    name: \"Text\",\n    blocks: [\n      { type: \"text\" },\n      {\n        type: \"text_print\",\n        values: {\n          TEXT: {\n            type: \"text\",\n            shadow: true,\n            fields: {\n              TEXT: \"abc\",\n            },\n          },\n        },\n      },\n    ],\n  },\n];\n\nconst ConfigFiles = {\n  INITIAL_XML,\n  INITIAL_TOOLBOX_XML,\n  INITIAL_TOOLBOX_JSON,\n  INITIAL_TOOLBOX_CATEGORIES,\n};\n\nexport default ConfigFiles;\n","/* eslint-disable import/no-extraneous-dependencies */\n\nimport React, { useRef, useState } from \"react\";\nimport Blockly from \"blockly\";\nimport * as Vi from 'blockly/msg/vi';\n\nimport { BlocklyWorkspace } from \"./index-workspace\";\nimport ConfigFiles from \"./initContent/content\";\n\nimport Button from 'react-bootstrap/Button';\nimport Interpreter from 'js-interpreter';\nimport { Spinner } from 'react-bootstrap'\n\n\n\nconst App = () => {\n  const [toolboxConfiguration, setToolboxConfiguration] = React.useState(\n    ConfigFiles.INITIAL_TOOLBOX_JSON\n  );\n  const btnRunRef = useRef()\n  const modalRef = [];\n  const [xml, setXml] = useState()\n  const [xmlInject, setXmlInject] = useState()\n  const [run, setRun] = useState(false)\n  const [workspace, setWorkspace] = useState()\n  const [uartFeedback, setUartFeedback] = useState(false)\n\n\n  /**\n   * \n   * INIT API FOR CUSTOM FUNCTION\n   * \n   */\n  Blockly.setLocale(Vi)\n  Blockly.JavaScript.STATEMENT_PREFIX = 'highlightBlock(%1);\\n';\n  // Blockly.JavaScript.STATEMENT_SUFFIX = 'waitForResponse();\\n';\n  Blockly.JavaScript.addReservedWords('highlightBlock');\n  Blockly.JavaScript.INFINITE_LOOP_TRAP = 'if(--LoopTrap == 0) { window.alert(\"You have reached maximum loops (100 loops)\"); \\n throw \"Infinite loop.\"};\\n';\n\n  function initApi(interpreter, globalObject) {\n    // Add an API function for highlighting blocks.\n    // Add an API function for the alert() block.\n    Blockly.JavaScript.addReservedWords('alert');\n    Blockly.JavaScript.addReservedWords('log');\n    Blockly.JavaScript.addReservedWords('prompt');\n    Blockly.JavaScript.addReservedWords('highlightBlock');\n    Blockly.JavaScript.addReservedWords('waitForSeconds');\n\n    var wrapper = function (text) {\n      return alert(arguments.length ? text : '');\n    };\n    interpreter.setProperty(globalObject, 'alert',\n      interpreter.createNativeFunction(wrapper));\n\n\n    wrapper = function (text) {\n      return console.log(arguments.length ? text : '');\n    };\n    interpreter.setProperty(globalObject, 'log',\n      interpreter.createNativeFunction(wrapper));\n\n    // Add an API function for the prompt() block.\n    wrapper = function (text) {\n      return prompt(text);\n    };\n    interpreter.setProperty(globalObject, 'prompt',\n      interpreter.createNativeFunction(wrapper));\n\n    wrapper = function (id) {\n      setUartFeedback(false)\n      return workspace.highlightBlock(id);\n    };\n    interpreter.setProperty(globalObject, 'highlightBlock',\n      interpreter.createNativeFunction(wrapper));\n\n    wrapper = function () {\n      setRun(false)\n      btnRunRef.current.disabled = false;\n      return workspace.highlightBlock(\"null\");\n    };\n    interpreter.setProperty(globalObject, 'resetHighlight',\n      interpreter.createNativeFunction(wrapper));\n\n    wrapper = interpreter.createAsyncFunction(\n      function (timeInSeconds, callback) {\n        // Delay the call to the callback.\n        console.log(callback)\n        setTimeout(callback, timeInSeconds);\n      });\n    interpreter.setProperty(globalObject, 'waitForSeconds', wrapper);\n\n    /**\n     * Bo chuyen dong\n     */\n\n    wrapper = function (num) {\n      try {\n        window.ReactNativeWebView.postMessage(\n          JSON.stringify({\n            REQUEST: 'UART',\n            DATA: 'f:' + num,\n          })\n        )\n      }\n      catch (error) {\n        alert(error)\n      }\n    };\n    interpreter.setProperty(globalObject, 'thang',\n      interpreter.createNativeFunction(wrapper));\n\n    wrapper = function (num) {\n      try {\n        window.ReactNativeWebView.postMessage(\n          JSON.stringify({\n            REQUEST: 'UART',\n            DATA: 'l:' + num,\n          })\n        )\n      }\n      catch (error) {\n        alert(error)\n      }\n    };\n    interpreter.setProperty(globalObject, 'trai',\n      interpreter.createNativeFunction(wrapper));\n\n    wrapper = function (num) {\n      try {\n        window.ReactNativeWebView.postMessage(\n          JSON.stringify({\n            REQUEST: 'UART',\n            DATA: 'r:' + num,\n          })\n        )\n      }\n      catch (error) {\n        alert(error)\n      }\n    };\n    interpreter.setProperty(globalObject, 'phai',\n      interpreter.createNativeFunction(wrapper));\n\n  }\n\n  window.addEventListener('android', function (event) {\n    var req = JSON.parse(event.data)\n\n    // if (event.data === \"ok\") {\n    //   setUartFeedback(true)\n    // }\n    if (req.REQUEST === \"XML\") {\n      console.log(\"XML INJECT!\")\n      setXmlInject(req.DATA)\n    }\n    // else {\n    //   setUartFeedback(false)\n    // }\n  });\n\n  window.setTimeout(() => {\n    if (!xmlInject) {\n      setXmlInject(ConfigFiles.INITIAL_XML)\n    }\n  }, 1000)\n\n\n  /**\n   * Inject custion features when component loaded\n   */\n\n\n  React.useEffect(() => {\n\n\n\n\n    // var myCode = 'alert(url);';\n    // var initFunc = function (interpreter, globalObject) {\n    //   var wrapper = function alert(text) {\n    //     return window.alert(text);\n    //   };\n    //   interpreter.setProperty(globalObject, 'alert',\n    //     interpreter.createNativeFunction(wrapper));\n    // };\n    // var myInterpreter = new Interpreter(myCode, initFunc);\n    // window.setTimeout(() => {\n    //   setToolboxConfiguration((prevConfig) => ({\n    //     ...prevConfig,\n    //     contents: [\n    //       ...prevConfig.contents,\n    //       {\n    //         kind: \"category\",\n    //         name: \"Them vao sau 2 giay\",\n    //         contents: [\n    //           { kind: \"block\", type: \"text\" },\n\n    //         ],\n    //         colour: 100\n    //       },\n    //     ],\n    //   }));\n    // }, 2000);\n\n    // window.setTimeout(() => {\n    //   setToolboxConfiguration((prevConfig) => ({\n    //     ...prevConfig,\n    //     contents: [\n    //       ...prevConfig.contents.slice(0, prevConfig.contents.length - 1),\n    //     ],\n    //   }));\n    // }, 4000);\n\n\n\n\n    //CUSTOM GIU THANG\n    const thang = {\n      \"type\": \"thang\",\n      \"message0\": \"Giữ thẳng %1 %2 mm\",\n      \"args0\": [\n        {\n          \"type\": \"input_dummy\"\n        },\n        {\n          \"type\": \"field_number\",\n          \"name\": \"THANG\",\n          \"value\": 0,\n          \"precision\": 1\n        }\n      ],\n      \"inputsInline\": true,\n      \"previousStatement\": null,\n      \"nextStatement\": null,\n      \"colour\": 75,\n      \"tooltip\": \"Giữ đai sắt thẳng với trong ... giây, độ chính xác milimét\",\n      \"helpUrl\": \"\"\n    }\n    Blockly.Blocks['thang'] = {\n      init: function () {\n        this.jsonInit(thang);\n        // Assign 'this' to a variable for use in the tooltip closure below.\n      }\n    };\n\n    Blockly.JavaScript['thang'] = function (block) {\n      var number_thang = block.getFieldValue('THANG');\n      // TODO: Assemble JavaScript into code variable.\n      var code = 'thang(' + number_thang + ')\\n';\n      return code;\n    };\n\n\n    //CUSTOM UON TRAI\n    const trai = {\n      \"type\": \"trai\",\n      \"message0\": \"Uốn trái %1 %2 độ\",\n      \"args0\": [\n        {\n          \"type\": \"input_dummy\"\n        },\n        {\n          \"type\": \"field_number\",\n          \"name\": \"TRAI\",\n          \"value\": 0,\n          \"precision\": 1\n        }\n      ],\n      \"inputsInline\": true,\n      \"previousStatement\": null,\n      \"nextStatement\": null,\n      \"colour\": 0,\n      \"tooltip\": \"Uốn trái đai sắt trong ... giây, độ chính xác 1 độ\",\n      \"helpUrl\": \"\"\n    }\n    Blockly.Blocks['trai'] = {\n      init: function () {\n        this.jsonInit(trai);\n        // Assign 'this' to a variable for use in the tooltip closure below.\n      }\n    };\n\n    Blockly.JavaScript['trai'] = function (block) {\n      var number_trai = block.getFieldValue('TRAI');\n      // TODO: Assemble JavaScript into code variable.\n      var code = 'trai(' + number_trai + ')\\n';\n      return code;\n    };\n\n\n    //CUSTOM UON PHAI\n    const phai = {\n      \"type\": \"phai\",\n      \"message0\": \"Uốn phải %1 %2 độ\",\n      \"args0\": [\n        {\n          \"type\": \"input_dummy\"\n        },\n        {\n          \"type\": \"field_number\",\n          \"name\": \"PHAI\",\n          \"value\": 0,\n          \"precision\": 1\n        }\n      ],\n      \"inputsInline\": true,\n      \"previousStatement\": null,\n      \"nextStatement\": null,\n      \"colour\": 0,\n      \"tooltip\": \"Uốn phải đai sắt trong ... giây, độ chính xác 1 độ\",\n      \"helpUrl\": \"\"\n    }\n    Blockly.Blocks['phai'] = {\n      init: function () {\n        this.jsonInit(phai);\n        // Assign 'this' to a variable for use in the tooltip closure below.\n      }\n    };\n\n    Blockly.JavaScript['phai'] = function (block) {\n      var number_trai = block.getFieldValue('PHAI');\n      // TODO: Assemble JavaScript into code variable.\n      var code = 'phai(' + number_trai + ')\\n';\n      return code;\n    };\n\n\n  }, []);\n\n  //CUSTOM DOI\n\n  const doi = {\n    \"type\": \"doi\",\n    \"message0\": \"đợi %1 mili-giây\",\n    \"args0\": [{\n      type: \"field_number\",\n      name: \"MILISECONDS\",\n      min: 0,\n      max: 600000,\n      value: 1\n    }],\n    \"previousStatement\": null,\n    \"nextStatement\": null,\n    \"colour\": 120,\n    \"tooltip\": \"Dừng hoạt động trong ... mili-giây, tối đa 10 phút (60 *10 * 1000)\",\n    \"helpUrl\": \"\"\n  }\n  Blockly.Blocks['doi'] = {\n    init: function () {\n      this.jsonInit(doi);\n      // Assign 'this' to a variable for use in the tooltip closure below.\n    }\n  };\n\n  Blockly.JavaScript['doi'] = function (block) {\n    var seconds = Number(block.getFieldValue('MILISECONDS'));\n    var code = 'waitForSeconds(' + seconds + ');\\n';\n    return code;\n  };\n\n  const onWorkspaceChange = React.useCallback((workspace) => {\n    workspace.registerButtonCallback(\"saveFile\", () => {\n      try {\n        window.ReactNativeWebView.postMessage(\n          JSON.stringify({\n            REQUEST: \"SAVE\",\n            DATA: xml,\n          })\n        )\n      }\n      catch (error) {\n        alert(error)\n      }\n      alert(\"Chương trình đã được lưu\");\n    });\n    console.log(Blockly.JavaScript.workspaceToCode(workspace));//debug\n    setWorkspace(workspace)\n  }, []);\n\n  const onXmlChange = React.useCallback((newXml) => {\n    console.log(newXml)\n    setXml(newXml)\n  }, []);\n\n  const handleView = (e) => {\n    // try { window.ReactNativeWebView.postMessage(code) }\n    // catch (error) {\n    //   alert(error)\n    // }\n    let element = document.getElementsByClassName(\"blocklyToolboxDiv\")[0];\n    if (element.style.opacity === '0') {\n\n      element.style.opacity = '1';\n      setTimeout(() => {\n        element.style.display = 'block';\n        window.dispatchEvent(new Event('resize'));\n      }, 300)\n    }\n    else {\n      element.style.opacity = '0'\n      setTimeout(() => {\n        element.style.display = 'none';\n        window.dispatchEvent(new Event('resize'));\n      }, 300)\n    }\n  }\n\n  const handleRun = (e) => {\n    //eval(code)\n    setRun(true)\n    btnRunRef.current.disabled = true;\n    console.log(btnRunRef.current.disabled);\n    let code = Blockly.JavaScript.workspaceToCode(workspace);\n    code = 'var LoopTrap = 100; \\n' + code + '\\n resetHighlight(); \\n';\n    var myInterpreter = new Interpreter(code, initApi);\n    function nextStep() {\n      if (myInterpreter.step()) {\n\n        // await (async function () {\n        //   return new Promise((resolve, reject) => {\n        //     window.setInterval(() => {\n        //       if (uartFeedback)\n        //         resolve(true)\n        //     }, 10)\n        //     window.setTimeout(() => { resolve(false) }, 5000)\n        //   }).then((result) => {\n        //     if (result)\n        //       nextStep();\n        //     else {\n        //       console.log(\"TIME OUT\")\n        //     }\n        //   })\n        // })()\n        window.setTimeout(nextStep, 0);\n      }\n    }\n    nextStep();\n  }\n\n  return (\n    <>\n      {xmlInject && <div>\n\n        <div className=\"btn-wrapper-view\">\n          <Button onClick={handleView} variant=\"outline-warning material-icons dodgerblue i-large\" className=\"btn-circle\">toll</Button>\n        </div>\n        <div className=\"btn-wrapper\">\n          <Button ref={btnRunRef} disabled={false} onClick={handleRun} variant=\"outline-warning\" className=\"btn-circle material-icons dodgerblue i-large\">{run ? \"more_horiz\" : \"flag\"}</Button>\n        </div>\n      </div>}\n\n      {xmlInject && <BlocklyWorkspace\n        toolboxConfiguration={toolboxConfiguration}\n        workspaceConfiguration={{\n          // grid: {\n          //   spacing: 20,\n          //   length: 3,\n          //   colour: \"#ccc\",\n          //   snap: true,\n          // },\n          zoom: {\n            controls: true,\n            wheel: false,\n            startScale: 1.0,\n            maxScale: 2,\n            minScale: 0.2,\n            scaleSpeed: 1.2,\n            pinch: true\n          },\n          horizontalLayout: true,\n          toolboxPosition: 'end',\n\n        }}\n        initialXml={xmlInject}\n        className=\"fill-height\"\n        onWorkspaceChange={onWorkspaceChange}\n        onXmlChange={onXmlChange}\n        onImportXmlError={() => alert(\"Không thể mở chương trình.\")}\n        modalRef={modalRef}\n\n      />\n      }\n      <div className=\"spin-container\">\n        {\n          !xmlInject && <Spinner animation=\"border\" variant=\"warning\" />\n        }\n        <div style={{ fontSize: 'large' }}>Đang tải...</div>\n      </div>\n\n    </>\n  );\n};\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\nimport 'material-icons/iconfont/material-icons.css';\nimport 'bootstrap/dist/css/bootstrap.min.css';\n// ReactDOM.render(<App />, document.getElementById('root'));\n\nwindow.addEventListener(\"load\", () => {\n    const editor = React.createElement(App);\n    ReactDOM.render(editor, document.getElementById(\"root\"));\n});\n\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}